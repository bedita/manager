(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(e,t,i){"use strict";(function(e){i.d(t,"a",function(){return n});var a=i(1),s=i.n(a);const n={loadBeditaPlugins(){BEDITA.plugins.forEach(t=>{const i=window[t]||e[t];if(i){const e=i.default;Object.keys(e).forEach(i=>{"object"==typeof e[i]&&(s.a.component(i,e[i]),console.debug(`%c[${i}]%c component succesfully registred from %c${t}%c Plugin`,"color: blue","color: black","color: red","color: black"))})}})}}}).call(this,i(2))},139:function(e,t,i){e.exports=i(156)},144:function(e,t,i){var a={};function s(e){var t=n(e);return i(t)}function n(e){var t=a[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}s.keys=function(){return Object.keys(a)},s.resolve=n,e.exports=s,s.id=144},146:function(e,t){},153:function(e,t,i){var a={"./af":12,"./af.js":12,"./ar":13,"./ar-dz":14,"./ar-dz.js":14,"./ar-kw":15,"./ar-kw.js":15,"./ar-ly":16,"./ar-ly.js":16,"./ar-ma":17,"./ar-ma.js":17,"./ar-sa":18,"./ar-sa.js":18,"./ar-tn":19,"./ar-tn.js":19,"./ar.js":13,"./az":20,"./az.js":20,"./be":21,"./be.js":21,"./bg":22,"./bg.js":22,"./bm":23,"./bm.js":23,"./bn":24,"./bn.js":24,"./bo":25,"./bo.js":25,"./br":26,"./br.js":26,"./bs":27,"./bs.js":27,"./ca":28,"./ca.js":28,"./cs":29,"./cs.js":29,"./cv":30,"./cv.js":30,"./cy":31,"./cy.js":31,"./da":32,"./da.js":32,"./de":33,"./de-at":34,"./de-at.js":34,"./de-ch":35,"./de-ch.js":35,"./de.js":33,"./dv":36,"./dv.js":36,"./el":37,"./el.js":37,"./en-au":38,"./en-au.js":38,"./en-ca":39,"./en-ca.js":39,"./en-gb":40,"./en-gb.js":40,"./en-ie":41,"./en-ie.js":41,"./en-il":42,"./en-il.js":42,"./en-nz":43,"./en-nz.js":43,"./eo":44,"./eo.js":44,"./es":45,"./es-do":46,"./es-do.js":46,"./es-us":47,"./es-us.js":47,"./es.js":45,"./et":48,"./et.js":48,"./eu":49,"./eu.js":49,"./fa":50,"./fa.js":50,"./fi":51,"./fi.js":51,"./fo":52,"./fo.js":52,"./fr":53,"./fr-ca":54,"./fr-ca.js":54,"./fr-ch":55,"./fr-ch.js":55,"./fr.js":53,"./fy":56,"./fy.js":56,"./gd":57,"./gd.js":57,"./gl":58,"./gl.js":58,"./gom-latn":59,"./gom-latn.js":59,"./gu":60,"./gu.js":60,"./he":61,"./he.js":61,"./hi":62,"./hi.js":62,"./hr":63,"./hr.js":63,"./hu":64,"./hu.js":64,"./hy-am":65,"./hy-am.js":65,"./id":66,"./id.js":66,"./is":67,"./is.js":67,"./it":68,"./it.js":68,"./ja":69,"./ja.js":69,"./jv":70,"./jv.js":70,"./ka":71,"./ka.js":71,"./kk":72,"./kk.js":72,"./km":73,"./km.js":73,"./kn":74,"./kn.js":74,"./ko":75,"./ko.js":75,"./ku":76,"./ku.js":76,"./ky":77,"./ky.js":77,"./lb":78,"./lb.js":78,"./lo":79,"./lo.js":79,"./lt":80,"./lt.js":80,"./lv":81,"./lv.js":81,"./me":82,"./me.js":82,"./mi":83,"./mi.js":83,"./mk":84,"./mk.js":84,"./ml":85,"./ml.js":85,"./mn":86,"./mn.js":86,"./mr":87,"./mr.js":87,"./ms":88,"./ms-my":89,"./ms-my.js":89,"./ms.js":88,"./mt":90,"./mt.js":90,"./my":91,"./my.js":91,"./nb":92,"./nb.js":92,"./ne":93,"./ne.js":93,"./nl":94,"./nl-be":95,"./nl-be.js":95,"./nl.js":94,"./nn":96,"./nn.js":96,"./pa-in":97,"./pa-in.js":97,"./pl":98,"./pl.js":98,"./pt":99,"./pt-br":100,"./pt-br.js":100,"./pt.js":99,"./ro":101,"./ro.js":101,"./ru":102,"./ru.js":102,"./sd":103,"./sd.js":103,"./se":104,"./se.js":104,"./si":105,"./si.js":105,"./sk":106,"./sk.js":106,"./sl":107,"./sl.js":107,"./sq":108,"./sq.js":108,"./sr":109,"./sr-cyrl":110,"./sr-cyrl.js":110,"./sr.js":109,"./ss":111,"./ss.js":111,"./sv":112,"./sv.js":112,"./sw":113,"./sw.js":113,"./ta":114,"./ta.js":114,"./te":115,"./te.js":115,"./tet":116,"./tet.js":116,"./tg":117,"./tg.js":117,"./th":118,"./th.js":118,"./tl-ph":119,"./tl-ph.js":119,"./tlh":120,"./tlh.js":120,"./tr":121,"./tr.js":121,"./tzl":122,"./tzl.js":122,"./tzm":123,"./tzm-latn":124,"./tzm-latn.js":124,"./tzm.js":123,"./ug-cn":125,"./ug-cn.js":125,"./uk":126,"./uk.js":126,"./ur":127,"./ur.js":127,"./uz":128,"./uz-latn":129,"./uz-latn.js":129,"./uz.js":128,"./vi":130,"./vi.js":130,"./x-pseudo":131,"./x-pseudo.js":131,"./yo":132,"./yo.js":132,"./zh-cn":133,"./zh-cn.js":133,"./zh-hk":134,"./zh-hk.js":134,"./zh-tw":135,"./zh-tw.js":135};function s(e){var t=n(e);return i(t)}function n(e){var t=a[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}s.keys=function(){return Object.keys(a)},s.resolve=n,e.exports=s,s.id=153},156:function(e,t,i){"use strict";i.r(t);var a=i(1),n=i.n(a);n.a.filter("humanize",function(e){return e.split("_").map(function(e){return e.charAt(0).toUpperCase()+e.substring(1)}).join(" ")});var o=i(4);i(145);const r={devtools:!0},l={delimiters:["<:",":>"]};for(let e in r)r.hasOwnProperty(e)&&(n.a.config[e]=r[e]);for(let e in l)l.hasOwnProperty(e)&&(n.a.options[e]=l[e]);!function(e){if(e){const t=i(144)(`./${e}/default.po`);Object(o.addLocale)(e,t),Object(o.useLocale)(e)}}(BEDITA.locale);const d={configFull:{toolbar:[{name:"document",groups:["mode"],items:["Source"]},{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","Subscript","Superscript","-","RemoveFormat"]},{name:"paragraph",groups:["list","blocks","align"],items:["NumberedList","BulletedList","-","Blockquote","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"editAttributes",items:["Attr"]},{name:"editing",groups:["find"],items:["Find","Replace"]},{name:"insert",items:["Image","Table","HorizontalRule","SpecialChar","Formula"]},{name:"tools",items:["ShowBlocks","AutoCorrect"]},{name:"styles",items:["Format","Styles"]},{name:"clipboard",groups:["clipboard","undo"],items:["Cut","Copy","Paste","PasteText","PasteFromWord","-","Undo","Redo"]}],allowedContent:!0,language:BEDITA.currLang2,entities:!1,fillEmptyBlocks:!1,forcePasteAsPlainText:!0,startupOutlineBlocks:!0,height:200},configNormal:{toolbar:[{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"paragraph",groups:["list","blocks","align"],items:["NumberedList","BulletedList"]},{name:"styles",items:["Format"]},{name:"links",items:["Link","Unlink"]},{name:"clipboard",groups:["clipboard","undo"],items:["PasteText","PasteFromWord","-","Undo","Redo"]},{name:"document",groups:["mode"],items:["Source"]}],format_tags:"p;h2",allowedContent:!0,language:BEDITA.currLang2,entities:!1,fillEmptyBlocks:!1,forcePasteAsPlainText:!0,startupOutlineBlocks:!0,height:200},configSimple:{toolbar:[{name:"document",groups:["mode"],items:["Source"]},{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","Subscript","Superscript","-","RemoveFormat"]},{name:"links",items:["Link","Unlink"]},{name:"clipboard",groups:["clipboard","undo"],items:["Undo","Redo"]},{name:"tools",items:["ShowBlocks"]}],allowedContent:!0,language:BEDITA.currLang2,entities:!1,fillEmptyBlocks:!1,forcePasteAsPlainText:!0,startupOutlineBlocks:!0,height:200}};i(146);var h=i(136),p={props:{ids:{type:String,default:()=>[]}},data:()=>({allIds:[],selectedRows:[]}),created(){try{this.allIds=JSON.parse(this.ids)}catch(e){console.error(e)}},computed:{selectedIds(){return JSON.stringify(this.selectedRows)},allChecked(){return JSON.stringify(this.selectedRows.sort())==JSON.stringify(this.allIds.sort())}},methods:{toggleAll(){this.allChecked?this.unCheckAll():this.checkAll()},checkAll(){this.selectedRows=JSON.parse(JSON.stringify(this.allIds))},unCheckAll(){this.selectedRows=[]},bulkActions(){this.selectedRows.length},exportSelected(){this.selectedRows.length<1||document.getElementById("form-export").submit()},exportAll(){this.unCheckAll(),this.$nextTick(()=>{document.getElementById("form-export").submit()})},trash(){this.selectedRows.length<1||confirm("Move "+this.selectedRows.length+" item to trash")&&document.getElementById("form-delete").submit()},selectRow(e){if("checkbox"!=e.target.type){e.preventDefault();var t=e.target.querySelector("input[type=checkbox]");let i=this.selectedRows.indexOf(t.value);-1!=i?this.selectedRows.splice(i,1):this.selectedRows.push(t.value)}}}};i(147);const c={count:0,page:1,page_size:20,page_count:1},u={q:"",filter:{type:""}},m={data:()=>({requestsQueue:[],requestController:new AbortController,objects:[],endpoint:null,pagination:c,query:{},formatObjetsFilter:["params","priority","position","url"]}),methods:{getPaginatedObjects(e=!0,t={}){let i=window.location.href;if(this.endpoint){t&&(this.query=t);let a=`${i}/${this.endpoint}`;const s={credentials:"same-origin",headers:{accept:"application/json"}};a=this.getUrlWithPaginationAndQuery(a),this.requestsQueue.length>0&&(this.requestController.abort(),this.requestController=new AbortController),s.signal=this.requestController.signal;let n=fetch(a,s).then(e=>e.json()).then(t=>{this.requestsQueue.pop();let i=(Array.isArray(t.data)?t.data:[t.data])||[];return t.data||(i=[]),this.requestsQueue.length<1&&(e&&(this.objects=i),this.pagination=t.meta&&t.meta.pagination||this.pagination,i)}).catch(e=>{if(this.requestsQueue.pop(),20===e.code)throw e;console.error(e)});return this.requestsQueue.push(n),n}return Promise.reject()},formatObjects(e){if(void 0===e)return[];const t=[];return e.forEach(e=>{let i={};i.id=e.id,i.type=e.type;const a=e.meta.relation;if(a){let e={};this.formatObjetsFilter.forEach(t=>{a[t]&&(e[t]=a[t])}),Object.keys(e).length&&(i.meta={relation:e})}t.push(i)}),t},setPagination(e){let t="",i="?";return Object.keys(this.pagination).forEach((e,i)=>{t+=`${i?"&":""}${e}=${this.pagination[e]}`}),-1===e.indexOf(i)||(i="&"),`${e}${i}${t}`},getUrlWithPaginationAndQuery(e){let t="",i="?";return Object.keys(this.pagination).forEach((e,i)=>{t+=`${i?"&":""}${e}=${this.pagination[e]}`}),t.length>1&&(t+="&"),Object.keys(this.query).forEach((e,i)=>{const a=this.query[e];let s=`${e}=${a}`;if("filter"===e){let e="";Object.keys(a).forEach(t=>{""!==a[t]&&(e+=`filter[${t}]=${a[t]}`)}),s=e}t+=`${i?"&":""}${s}`}),-1===e.indexOf(i)||(i="&"),`${e}${i}${t}`},findObjectById(e){let t=this.objects.filter(t=>t.id===e);return t.length&&t[0]},async loadMore(e=c.page_size){if(this.pagination.page_items<this.pagination.count){let t=await this.nextPage(!1);this.pagination.page_items=this.pagination.page_items+e<=this.pagination.count?this.pagination.page_items+e:this.pagination.count;const i=this.objects.length;this.objects.splice(i,0,...t)}},toPage(e,t={}){return this.pagination.page=e||1,this.getPaginatedObjects(!0,t)},firstPage(e=!0){return 1!==this.pagination.page?(this.pagination.page=1,this.getPaginatedObjects(e)):Promise.resolve([])},lastPage(e=!0){return this.pagination.page!==this.pagination.page_count?(this.pagination.page=this.pagination.page_count,this.getPaginatedObjects(e)):Promise.resolve([])},nextPage(e=!0){return this.pagination.page<this.pagination.page_count?(this.pagination.page=this.pagination.page+1,this.getPaginatedObjects(e)):Promise.resolve([])},prevPage(){return this.pagination.page>1?(this.pagination.page=this.pagination.page-1,this.getPaginatedObjects()):Promise.resolve()},setPageSize(e){this.pagination.page_size=e,this.pagination.page=1}}};var g={mixins:[m],props:{relationName:{type:String,required:!0},viewVisibility:{type:Boolean,default:()=>!1},addedRelations:{type:Array,default:()=>[]},hideRelations:{type:Array,default:()=>[]}},computed:{keyEvents(){return{esc:{keyup:this.handleKeyboard}}}},data:()=>({method:"relationshipsJson",loading:!1,pendingRelations:[],relationsData:[],isVisible:!1}),created(){this.endpoint=`${this.method}/${this.relationName}`},watch:{addedRelations(e){this.pendingRelations=e},pendingRelations(e){this.relationsData=this.relationFormatterHelper(e)},viewVisibility(e){this.isVisible=e},isVisible(){this.objects.length||this.loadObjects(),this.$nextTick(()=>{this.isVisible&&this.$refs.inputFilter&&this.$refs.inputFilter.focus()}),this.$emit("visibility-setter",this.isVisible)},loading(e){this.$parent.$emit("loading",e)}},methods:{async loadObjects(){this.loading=!0;let e=this.getPaginatedObjects();return e.then(e=>(this.loading=!1,e)).catch(e=>{20!==e.code&&(this.loading=!1,console.error(e))}),e},appendRelations(){this.$emit("append-relations",this.pendingRelations),this.isVisible=!1},handleKeyboard(e){this.isVisible&&(e.stopImmediatePropagation(),e.preventDefault(),this.hideRelationshipModal())},hideRelationshipModal(){this.pendingRelations=this.addedRelations,this.isVisible=!1},hasElementsToShow(){return this.objects.filter(e=>!this.hideRelations.filter(t=>e.id===t.id).length).length},relationFormatterHelper(e,t){let i="";try{i=JSON.stringify(e)}catch(e){console.error(e)}return i},containsId:(e,t)=>e.filter(e=>e.id===t).length}},f={extends:g,data:()=>({method:"resourcesJson",removedRelations:[]}),props:{relatedObjects:{type:Array,default:()=>[]}},mounted(){this.loadObjects()},computed:{checkedRelations:{get:function(){return this.relatedObjects.concat(this.pendingRelations).filter(e=>!this.containsId(this.removedRelations,e.id))},set:function(e){let t=e.filter(e=>!this.containsId(this.relatedObjects,e.id));this.pendingRelations=t;let i=this.relatedObjects.filter(t=>!this.containsId(e,t.id));this.removedRelations=i,this.$emit("remove-relations",i)}}}},y={name:"InputDynamicAttributes",props:{value:{type:[String,Boolean]},attrs:{type:Object,required:!0}},render(e){const t=this.attrs,i=Object.keys(t).filter(e=>e.startsWith("v-")).map(e=>{return{name:e.split("v-").pop()}});let a={value:this.value},s={input:e=>{this.$emit("update:value",e.target.value)}};return"checkbox"===t.type&&(a={checked:"true"===this.value},s={input:e=>{this.$emit("update:value",e.target.checked)}}),delete t.time,e("input",{directives:i,attrs:t,domProps:a,on:s})}},b=i(5),v={components:{InputDynamicAttributes:y},template:`\n    <form :name="objectsLabel" submit="applyFilter" action="noaction">\n        <nav class="pagination has-text-size-smallest">\n\n            <div class="count-items" v-if="pagination.count">\n                <span><: pagination.count :> <: objectsLabel :></span>\n            </div>\n\n\n            <div class="filter-search">\n                <span class="search-query">\n                    <input type="text"\n                        :placeholder="placeholder"\n                        v-model="queryFilter.q"\n                        @keyup.prevent.stop="onQueryStringChange"\n                        @keyup.enter.prevent.stop="applyFilter"/>\n                </span>\n\n                <span v-if="rightTypes.length > 1" class="search-types">\n                    <select v-model="queryFilter.filter.type">\n                        <option value="" label="${o["t"]`All Types`}"></option>\n                        <option v-for="type in rightTypes"><: type :> </option>\n                    </select>\n                </span>\n\n                <button v-show="showFilterButtons" name="applysearch" @click.prevent="applyFilter()"><: applyFilterLabel :></button>\n                <button v-show="showFilterButtons" name="resetsearch" @click.prevent="resetFilter()"><: resetFilterLabel :></button>\n            </div>\n\n            <div class="filter-list">\n                <div v-for="filter in filterList" class="filter-container input" :class="[filter.name, filter.type]">\n                    <input type="hidden" :name="filter.name" :value="filter.value">\n\n                    <span class="filter-name" :title="filterLabel(filter.name)"><: filter.name :></span>\n\n                    <span v-if="filter.type === 'select' || filter.type === 'radio'">\n                        <select v-model="queryFilter.filter[filter.name]" :id="filter.name">\n                            <option value="">\n                                All\n                            </option>\n                            <option v-for="option in filter.options" :name="option.name" :value="option.value">\n                                <: option.text :>\n                            </option>\n                        </select>\n                    </span>\n\n                    <span v-else-if="filter.type === 'checkbox'">\n                        <label>Any</label>\n                        <input type="radio" v-model="queryFilter.filter[filter.name]" value="">\n                        <label>Yes</label>\n                        <input type="radio" v-model="queryFilter.filter[filter.name]" value="true">\n                        <label>No</label>\n                        <input type="radio" v-model="queryFilter.filter[filter.name]" value="false">\n                    </span>\n\n                    <template v-else-if="filter.date">\n                        <span class="datepicker-container">\n                            <label>From:\n                            <input-dynamic-attributes :value.sync="queryFilter.filter[filter.name]['gte']" :attrs="filter" :time="false" />\n                            </label>\n                        </span>\n                        <span class="datepicker-container">\n                            <label>To:\n                            <input-dynamic-attributes :value.sync="queryFilter.filter[filter.name]['lte']" :attrs="filter" :time="false" />\n                            </label>\n                        </span>\n                    </template>\n\n                    <span v-else>\n                        <input-dynamic-attributes :value.sync="queryFilter.filter[filter.name]" :attrs="filter"/>\n                    </span>\n                </div>\n            </div>\n\n            <div class="page-size" :class="pagination.count <= paginateSizes[0] && 'hide'">\n                <span><: pageSizesLabel :>:</span>\n                <select class="page-size-selector has-background-gray-700 has-border-gray-700 has-text-gray-200 has-text-size-smallest has-font-weight-light" v-model="pageSize">\n                    <option v-for="size in paginateSizes"><: size :></option>\n                </select>\n            </div>\n\n            <div class="pagination-buttons" :class="pagination.count <= pagination.page_size && 'hide'">\n                <div class="pages-buttons full-layout" v-if="isFullPaginationLayout">\n                    <button\n                        v-for="i in pagination.page_count" :key="i"\n                        v-bind:class="pagination.page == i? '' : 'is-dark'"\n                        v-bind:style="pagination.page == i? 'pointer-events: none' : ''"\n                        class="has-text-size-smallest" @click.prevent="changePage(i)"><: i :>\n                    </button>\n                </div>\n\n                <div class="pages-buttons full-layout" v-if="!isFullPaginationLayout">\n                    \x3c!-- first page ---\x3e\n                    <button v-if="pagination.page > 1" class="has-text-size-smallest" @click.prevent="changePage(1)"><: 1 :></button>\n\n                    \x3c!-- delimiter ---\x3e\n                    <span v-if="pagination.page > 3" class="pages-delimiter">...</span>\n\n                    \x3c!-- prev page ---\x3e\n                    <button v-if="pagination.page > 2" class="has-text-size-smallest" @click.prevent="changePage(pagination.page - 1)"><: pagination.page - 1:></button>\n\n                    \x3c!-- current page ---\x3e\n                    <button class="is-dark current-page has-text-size-smallest" @click.prevent="changePage(pagination.page)"><: pagination.page :></button>\n\n                    \x3c!-- next page ---\x3e\n                    <button v-if="pagination.page < pagination.page_count-1" class="has-text-size-smallest" @click.prevent="changePage(pagination.page + 1)"><: pagination.page + 1:></button>\n\n                    \x3c!-- delimiter ---\x3e\n                    <span v-if="pagination.page < pagination.page_count-2" class="pages-delimiter">...</span>\n\n                    \x3c!-- last page ---\x3e\n                    <button v-if="pagination.page < pagination.page_count" class="has-text-size-smallest" @click.prevent="changePage(pagination.page_count)"><: pagination.page_count :></button>\n                </div>\n\n            </div>\n\n        </nav>\n    </form>\n    `,props:{applyFilterLabel:{type:String,default:"Apply"},resetFilterLabel:{type:String,default:"Reset"},objectsLabel:{type:String,default:"Objects"},pageSizesLabel:{type:String,default:"Size"},placeholder:{type:String,default:"Search"},showFilterButtons:{type:Boolean,default:!0},initFilter:{type:Object,default:()=>({q:"",filter:{type:""}})},relationTypes:{type:Object},filterList:{type:Array},pagination:{type:Object,default:()=>c},configPaginateSizes:{type:String,default:"[10]"}},data(){return{queryFilter:{},timer:null,pageSize:this.pagination.page_size}},created(){let e=this.loadCustomFilters();this.queryFilter=b.a.all([u,this.queryFilter,e,this.initFilter])},computed:{paginateSizes(){return JSON.parse(this.configPaginateSizes)},rightTypes(){return this.relationTypes&&this.relationTypes.right||[]},isFullPaginationLayout(){return this.pagination.page_count>1&&this.pagination.page_count<=7}},watch:{initFilter(e){this.queryFilter=Object(b.a)(this.queryFilter,e)},pageSize(e){this.$emit("filter-update-page-size",this.pageSize)}},methods:{onQueryStringChange(){let e=this.queryFilter.q||"";clearTimeout(this.timer),(e.length>=3||0==e.length)&&(this.timer=setTimeout(()=>{this.$emit("filter-objects",this.queryFilter)},300))},loadCustomFilters(){let e={};return this.filterList&&this.filterList.forEach(t=>e[t.name]=t.date?{}:""),{filter:e}},applyFilter(){this.$emit("filter-objects-submit",this.queryFilter)},resetFilter(){this.$emit("filter-reset")},filterLabel:e=>`filter name ${e}`,changePage(e){this.$emit("filter-update-current-page",e)}}},j={name:"tree-list",template:'\n        <div\n            class="tree-list-node"\n            :class="treeListMode">\n\n            <div v-if="!isRoot">\n                <div v-if="multipleChoice"\n                    class="node-element"\n                    :class="{\n                        \'tree-related-object\': isRelated,\n                        \'disabled\': isCurrentObjectInPath,\n                        \'node-folder\': isFolder,\n                    }">\n\n                    <span\n                        @click.prevent.stop="toggle"\n                        class="icon"\n                        :class="nodeIcon"\n                        ></span>\n                    <input\n                        type="checkbox"\n                        :value="item"\n                        v-model="related"\n                    />\n                    <label\n                        @click.prevent.stop="toggle"\n                        :class="isFolder ? \'is-folder\' : \'\'"><: caption :></label>\n                </div>\n                <div v-else class="node-element"\n                    :class="{\n                        \'tree-related-object\': isRelated || stageRelated,\n                        \'was-related-object\': isRelated && !stageRelated,\n                        \'disabled\': isCurrentObjectInPath\n                    }"\n\n                    @click.prevent.stop="select">\n                    <span\n                        @click.prevent.stop="toggle"\n                        class="icon"\n                        :class="nodeIcon"\n                        ></span>\n                    <label><: caption :></label>\n                </div>\n            </div>\n            <div :class="isRoot ? \'\' : \'node-children\'" v-show="open" v-if="isFolder">\n                <tree-list\n                    @add-relation="addRelation"\n                    @remove-relation="removeRelation"\n                    @remove-all-relations="removeAllRelations"\n                    v-for="(child, index) in item.children"\n                    :key="index"\n                    :item="child"\n                    :multiple-choice="multipleChoice"\n                    :related-objects="relatedObjects"\n                    :object-id=objectId>\n                </tree-list>\n            </div>\n        </div>\n    ',data:()=>({stageRelated:!1,related:!1,open:!0}),props:{multipleChoice:{type:Boolean,default:!0},captionField:{type:String,required:!1,default:"name"},childrenField:{type:String,required:!1,default:"children"},item:{type:Object,required:!0,default:()=>{}},relatedObjects:{type:Array,default:()=>[]},objectId:{type:String,required:!1}},computed:{caption(){return this.item[this.captionField]},isFolder(){return this.item.children&&!!this.item.children.length},isRoot(){return this.item.root||!1},isRelated(){return!!this.item.id&&!!this.relatedObjects.filter(e=>e.id===this.item.id).length},isCurrentObjectInPath(){return this.item&&this.item.object&&-1!==this.item.object.meta.path.indexOf(this.objectId)},nodeIcon(){let e="";return e+=this.isFolder?this.open?"icon-down-dir":"icon-right-dir":"unicode-branch"},treeListMode(){let e=[];return this.isRoot&&e.push("root-node"),this.multipleChoice?e.push("tree-list-multiple-choice"):e.push("tree-list-single-choice"),this.isCurrentObject&&e.push("disabled"),e.join(" ")}},watch:{related(e){this.stageRelated=e},stageRelated(e){this.item.object&&(e?this.$emit("add-relation",this.item.object):this.$emit("remove-relation",this.item.object))},relatedObjects(){this.related=this.isRelated}},methods:{toggle(){this.isFolder&&(this.open=!this.open)},addRelation(e){this.$emit("add-relation",e)},removeRelation(e){this.$emit("remove-relation",e)},removeAllRelations(){this.$emit("remove-all-relations")},select(){this.isCurrentObjectInPath||(this.$emit("remove-all-relations"),this.stageRelated=!this.stageRelated)}}},P=i(3),R={extends:g,components:{TreeList:j},props:{relatedObjects:{type:Array,default:()=>[]},loadOnStart:[Boolean,Number],multipleChoice:{type:Boolean,default:!0}},data:()=>({jsonTree:{}}),created(){this.loadTree()},watch:{pendingRelations(e){let t=e.filter(e=>!this.isRelated(e.id));this.multipleChoice||t.length&&(t=t[0]);const i=!!t.length;this.$el.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:this.$vnode.tag,isChanged:i}})),this.relationsData=this.relationFormatterHelper(t);let a=this.relatedObjects.filter(e=>!this.isPending(e.id));this.$emit("remove-relations",a)},objects(){this.pendingRelations=this.objects.filter(e=>this.isRelated(e.id))}},methods:{async loadTree(){if(this.loadOnStart){var e="number"==typeof this.loadOnStart?this.loadOnStart:0;await Object(P.a)(e),await this.loadObjects(),this.jsonTree={name:"Root",root:!0,object:{},children:this.createTree()}}},addRelation(e){e&&void 0!==!e.id?this.containsId(this.pendingRelations,e.id)||this.pendingRelations.push(e):console.error("[addRelation] needs first param (related) as {object} with property id set")},removeRelation(e){e&&e.id?this.pendingRelations=this.pendingRelations.filter(t=>t.id!==e.id):console.error("[removeRelation] needs first param (related) as {object} with property id set")},removeAllRelations(){this.pendingRelations=[],this._setChildrenData(this,"stageRelated",!1)},_setChildrenData(e,t,i){void 0!==e&&t in e&&(e[t]=i),e.$children.forEach(e=>{this._setChildrenData(e,t,i)})},createTree(){let e=[];return this.objects.forEach(t=>{let i=t.meta.path&&t.meta.path.split("/");if(i.length){i.shift();let a=e;i.forEach(e=>{let i=this.findPath(a,e);if(i)a=i.children;else{let i=t;i.id!==e&&(i=this.findObjectById(e));let s={id:e,related:this.isRelated(e),name:i.attributes.title||"",object:i,children:[]};a.push(s),a=s.children}})}}),e},findPath(e,t){let i=e.filter(e=>e.id===t);return!!i.length&&i[0]},isRelated(e){return!!this.relatedObjects.filter(t=>e===t.id).length},isPending(e){return!!this.pendingRelations.filter(t=>e===t.id).length}}},O=i(7),w=i.n(O);var k={inject:["requestPanel","closePanel"],mixins:[m,{data:()=>({relationData:null,relationSchema:null,relationTypes:null}),methods:{getRelationData(){let e=window.location.href;if(this.relationName){let t=`${e}/relationData/${this.relationName}`;const i={credentials:"same-origin",headers:{accept:"application/json"}};return this.relationData?Promise.resolve(this.relationData):fetch(t,i).then(e=>e.json()).then(e=>{if(e.data&&e.data.attributes)return this.relationData=e.data.attributes,this.relationSchema=this.getRelationSchema(),this.relationTypes={left:e.data.left,right:e.data.right},this.relationData}).catch(e=>{console.error(e)})}return console.error("[RelationSchemaMixin] relationName not defined - can't load relation schema"),Promise.reject()},relationHasParams(){return null!==this.relationData&&!!this.getRelationSchema()},getRelationSchema(){return null===this.relationSchema&&(this.relationSchema=null!==this.relationData&&this.relationData.params&&this.relationData.params.properties),this.relationSchema},getParamHelper:(e,t)=>e.meta.relation.params&&e.meta.relation.params[t]||null}}],components:{RelationshipsView:g,RolesListView:f,FilterBoxView:v,TreeView:R},props:{relationName:{type:String,required:!0},loadOnStart:[Boolean,Number],multipleChoice:{type:Boolean,default:!0},configPaginateSizes:{type:String,default:"[]"}},data:()=>({method:"relatedJson",loading:!1,count:0,removedRelated:[],addedRelations:[],modifiedRelations:[],removedRelationsData:[],addedRelationsData:[],relationsData:[],activeFilter:{}}),computed:{alreadyInView(){var e=this.addedRelations.map(e=>e.id),t=this.objects.map(e=>e.id);return e.concat(t)}},created(){this.endpoint=`${this.method}/${this.relationName}`},mounted(){this.loadOnMounted()},watch:{loading(e){this.$emit("loading",e)}},methods:{onFilterObjects(e){this.activeFilter=e,this.toPage(1,this.activeFilter)},onUpdatePageSize(e){this.setPageSize(e),this.loadRelatedObjects(this.activeFilter)},onUpdateCurrentPage(e){this.toPage(e,this.activeFilter)},async loadOnMounted(){if(this.loadOnStart){var e="number"==typeof this.loadOnStart?this.loadOnStart:0;await Object(P.a)(e),null===this.relationSchema&&await this.getRelationData(),await this.loadRelatedObjects()}},async loadRelatedObjects(e={},t=!1){this.loading=!0;let i=this.getPaginatedObjects(!0,e);return i.then(e=>(this.$emit("count",this.pagination.count),this.loading=!1,e)).catch(e=>{20!==e.code&&(this.loading=!1,console.error(e),s)}),i},reloadObjects(){return this.activeFilter={},this.loadRelatedObjects({},!0)},relationToggle(e){e&&e.id?this.containsId(this.removedRelated,e.id)?this.restoreRemovedRelation(e):this.removeRelation(e):console.error("[relationToggle] needs first param (related) as {object} with property id set")},removeRelation(e){this.removedRelated.push(e),this.prepareRelationsToRemove(this.removedRelated),this.containsId(this.modifiedRelations,e.id)&&this.prepareRelationsToSave()},restoreRemovedRelation(e){let t=this.removedRelated.findIndex(t=>t.id!==e.id);this.removedRelated.splice(t,1),this.prepareRelationsToRemove(this.removedRelated),this.containsId(this.modifiedRelations,e.id)&&this.prepareRelationsToSave()},prepareRelationsToRemove(e){this.removedRelationsData=JSON.stringify(this.formatObjects(e));const t=!!e.length;this.$el.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:this.$vnode.tag,isChanged:t}}))},setRemovedRelated(e){e&&(this.removedRelated=e,this.prepareRelationsToRemove(this.removedRelated))},removeAddedRelations(e){e?(this.addedRelations=this.addedRelations.filter(t=>t.id!==e),this.prepareRelationsToSave()):console.error("[removeAddedRelations] needs first param (id) as {Number|String}")},modifyRelation(e){this.containsId(this.modifiedRelations,e.id)?this.modifiedRelations=this.modifiedRelations.map(t=>t.id===e.id?e:t):this.modifiedRelations.push(e),this.prepareRelationsToSave()},removeModifiedRelations(e){e?(this.modifiedRelations=this.modifiedRelations.filter(t=>t.id!==e),this.prepareRelationsToSave()):console.error("[removeModifiedRelations] needs first param (id) as {Number|String}")},updateRelationParams(e){const t=e.related.id,i=this.objects.filter(e=>{if(e.id===t)return e}).pop();this.modifyRelation(i)},appendRelations(e){if(this.addedRelations.length){let t=this.addedRelations.map(e=>e.id);for(let i=0;i<e.length;i++)t.indexOf(e[i].id)<0&&this.addedRelations.push(e[i])}else this.addedRelations=e;this.prepareRelationsToSave()},prepareRelationsToSave(){let e=this.addedRelations.concat(this.modifiedRelations).filter(e=>!this.containsId(this.removedRelated,e.id));this.addedRelationsData=JSON.stringify(this.formatObjects(e));const t=!!e.length;this.$el.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:this.$vnode.tag,isChanged:t}}))},formatParam(e,t){const i=this.getRelationSchema();return void 0!==i&&"date-time"===i[e].format?w.a.formatDate(new Date(t),"Y-m-d h:i K"):t},toPage(e,t){this.loading=!0,m.methods.toPage.call(this,e,t).then(e=>(this.loading=!1,e)).catch(e=>{20!==e.code&&(this.loading=!1,console.error(e))})},containsId:(e,t)=>e.filter(e=>e.id===t).length,buildViewUrl:(e,t)=>`${window.location.protocol}//${window.location.host}/${e}/view/${t}`}},S={components:{PropertyView:{components:{RelationView:k,ChildrenView:{extends:k,data:()=>({positions:{}}),methods:{updatePosition(e){const t=e.meta.relation.position,i=""!==this.positions[e.id]?this.positions[e.id]:void 0;if(i!==t)try{const t=JSON.parse(JSON.stringify(e));t.meta.relation.position=i,this.modifyRelation(t)}catch(e){console.error("[ChildrenView -> updatePosition] something's wrong with the data")}else this.removeModifiedRelations(e.id)}}}},props:{tabOpen:{type:Boolean,default:!1},tabOpenAtStart:{type:Boolean,default:!1},isDefaultOpen:{type:Boolean,default:!1}},data(){return{isOpen:this.isDefaultOpen,isLoading:!1,totalObjects:0}},mounted(){this.isOpen=this.tabOpenAtStart},watch:{tabOpen(){this.isOpen=this.tabOpen}},methods:{toggleVisibility(){this.isOpen=!this.isOpen},onToggleLoading(e){this.isLoading=e},onCount(e,t=!1){(0===this.totalObjects||t)&&(this.totalObjects=e)}}},RelationView:k},data:()=>({tabsOpen:!0}),computed:{keyEvents(){return{esc:{keyup:this.toggleTabs}}}},methods:{toggleTabs(){return this.tabsOpen=!this.tabsOpen}}},T={extends:p,methods:{restoreItem(){this.selectedRows.length<1||document.getElementById("form-restore").submit()},deleteItem(){this.selectedRows.length<1||confirm("Confirm deletion of "+this.selectedRows.length+" item from the trash")&&document.getElementById("form-delete").submit()}}},$={extends:S},F={data:()=>({fileName:""}),computed:{},methods:{onFileChanged(e){this.fileName=e.target.files[0].name}}},x=i(9),C=i.n(x),z={extends:p,components:{AutosizeTextarea:{props:["value","reset-value"],template:'<textarea @input="handleChange" :value="text"></textarea>',data:()=>({text:"",originalValue:""}),watch:{text(){this.$nextTick(()=>{C()(this.$el)})},value(){this.originalValue=this.value}},mounted(){this.originalValue=this.value,this.text=this.value,this.$nextTick(()=>{C()(this.$el)})},methods:{handleChange(e){this.text=event.target.value,this.$emit("input",this.text)}}}},props:{resources:{},csrfToken:{type:String,required:!0}},data:()=>({propertyTypes:[],deletedPropertyTypes:[],savedPropertyTypes:[],newPropertyTypes:[],removePropertyTypes:[],editPropertyTypes:[]}),mounted(){this.propertyTypes=JSON.parse(this.resources)},computed:{formIsModified(){const e=!!(this.newPropertyTypes.length||this.removePropertyTypes.length||this.editPropertyTypes.length);return this.$el&&this.$el.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:this.$vnode.tag,isChanged:e}})),e}},methods:{editPropParams(e,t){let i=null;try{""!==t&&(i=JSON.parse(t),Object.keys(i).length||(i=null))}catch(e){return void console.info("[editPropParams] params JSON parse failed - skipping this one...")}const a={id:e,attributes:{params:i}};this.editPropertyType(a)},editPropName(e,t){const i={id:e,attributes:{name:t}};this.editPropertyType(i)},addRow(){this.newPropertyTypes.push({name:"",params:""})},removeRow(e){const t=this.newPropertyTypes.indexOf(e);-1!==t&&this.newPropertyTypes.splice(t,1)},removePropertyType(e){this.removePropertyTypes.push(e)},undoRemovePropertyType(e){const t=this.removePropertyTypes.indexOf(e);-1!==t&&this.removePropertyTypes.splice(t,1)},save(e){if(this.removePropertyTypes.length&&!confirm(`Do you really want to trash these property types? ${this.removePropertyTypes.join(", ")}`))return void e.preventDefault();let t=window.location.href.replace(window.location.search,""),i=new Headers({"Content-Type":"application/json",Accept:"application/json","X-CSRF-Token":this.csrfToken}),a={_csrfToken:this.csrfToken,addPropertyTypes:[...this.newPropertyTypes],removePropertyTypes:[...this.removePropertyTypes],editPropertyTypes:[...this.editPropertyTypes]};const s={method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify(a)},n=`${t}/savePropertyTypesJson`;fetch(n,s).then(e=>e.json()).then(e=>{const t=e.saved||[],i=e.removed||[],a=e.edited||[];this.savedPropertyTypes.push(...t),this.deletedPropertyTypes.push(...i),a.forEach(e=>{this.propertyTypes=this.propertyTypes.map(t=>t.id===e.id?e:t),this.savedPropertyTypes=this.savedPropertyTypes.map(t=>t.id===e.id?e:t)}),this.$children.forEach(e=>{try{JSON.parse(e.text)}catch(t){e.text=e.originalValue}}),this.newPropertyTypes=[],this.removePropertyTypes=[],this.editPropertyTypes=[]}).catch(e=>{console.log(e)})},editPropertyType(e){let t=[...this.propertyTypes,...this.savedPropertyTypes];const[i]=t.filter(t=>t.id==e.id);this.editPropertyTypes.filter(t=>t.id===e.id).length?this.editPropertyTypes=this.editPropertyTypes.map(t=>t.id===e.id?{id:e.id,attributes:{...t.attributes,...e.attributes}}:t):this.editPropertyTypes.push(e),this.editPropertyTypes=this.editPropertyTypes.filter(e=>{return!(Object.keys(e.attributes).filter(t=>JSON.stringify(e.attributes[t])===JSON.stringify(i.attributes[t])).length===Object.keys(e.attributes).length)})},formatParams(e){let t="";if(e&&e.attributes&&e.attributes.params)try{t=JSON.stringify(e.attributes.params,null,4)}catch(e){t=e.message}return t},containsId:(e,t)=>e.filter(e=>"object"==typeof e&&"id"in e?e.id===t:e===t).length}},I=(i(151),{inject:["returnDataFromPanel","closePanel"],mixins:[m],components:{FilterBoxView:v},props:{relationName:{type:String,default:""},alreadyInView:{type:Array,default:()=>[]},relationTypes:{type:Object},configPaginateSizes:{type:String,default:"[]"}},data:()=>({method:"relationshipsJson",endpoint:"",selectedObjects:[],activeFilter:{},loading:!1}),watch:{relationName:{immediate:!0,handler(e,t){e&&(this.selectedObjects=[],this.endpoint=`${this.method}/${e}`,this.loadObjects()),""===e&&Object(P.a)(500).then(()=>this.objects=[])}},loading(e){this.$emit("loading",e)}},methods:{onFilterObjects(e){this.activeFilter=e,this.toPage(1,this.activeFilter)},onUpdatePageSize(e){this.setPageSize(e),this.loadObjects(this.activeFilter)},onUpdateCurrentPage(e){this.toPage(e,this.activeFilter)},paginationPageLinkVisible(e){return this.pagination.page_count<=7||(1===e||e===this.pagination.page_count||e>=this.pagination.page-1&&e<=this.pagination.page+1)},toggle(e,t){let i=this.selectedObjects.indexOf(e);-1!=i?this.selectedObjects.splice(i,1):this.selectedObjects.push(e)},async loadObjects(e){this.objects=[],this.loading=!0;let t=await this.getPaginatedObjects(!0,e);return this.loading=!1,this.$emit("count",this.pagination.count),t},async toPage(e,t){this.objects=[],this.loading=!0;let i=await m.methods.toPage.call(this,e,t);return this.loading=!1,i},buildViewUrl:(e,t)=>`${window.location.protocol}//${window.location.host}/${e}/view/${t}`}}),E={inject:["returnDataFromPanel","closePanel"],props:{relation:{type:Object,default:()=>{}}},computed:{relatedStatus(){return this.relation.related.attributes.status},relatedType(){let e="(not available)";return this.relation&&this.relation.related&&(e=this.relation.related.type),e},relatedName(){let e="(empty)";return this.relation&&this.relation.related&&(e=this.relation.related.attributes.title),e}},data:()=>({oldParams:{},editingParams:{},priority:null,isModified:!1}),watch:{relation(e){e?(Object.assign(this.oldParams,e.related.meta.relation.params),Object.assign(this.editingParams,e.related.meta.relation.params),this.priority=e.related.meta.relation.priority):(this.oldParams={},this.editingParams={},this.isModified=!1,this.priority=null)}},methods:{saveParams(){Object.keys(this.editingParams).length?this.relation.related.meta.relation.params=this.editingParams:delete this.relation.related.meta.relation.params,this.relation.related.meta.relation.priority=this.priority,this.closeParamsView(),this.returnDataFromPanel({action:"edit-params",item:this.relation})},closeParamsView(){this.editingParams={},this.closePanel()},checkParams(){this.isModified=!!Object.keys(this.editingParams).filter(e=>""!==this.editingParams[e]&&this.editingParams[e]!==this.oldParams[e]).length||this.relation.related.meta.relation.priority!==this.priority}}},q=i(0),A=i.n(q);i(154);const D={enableTime:!0,altInput:!0,dateFormat:"Z",altFormat:"D/M/Y HH:mm",animate:!1,time_24hr:!0},N={enableTime:!1,altInput:!0,dateFormat:"Z",altFormat:"D/M/Y",animate:!1,time_24hr:!0};var B={install(e){e.directive("datepicker",{inserted(e,t,i){let a=N;i.data&&i.data.attrs&&"true"===i.data.attrs.time&&(a=D),a.formatDate=((e,t)=>{if("Z"===t)return A()(e).toISOString();let i=(new Date).getTimezoneOffset()/60,a=`${t} (UTC${i<0?"+":"-"}${Math.abs(i)})`;return A()(e).format(a)});try{let t=w()(e,a);e.dataset.originalValue=e.value;let i=document.createElement("span");i.classList.add("clear-button"),i.innerHTML="&times;",i.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),t.clear()}),e.parentElement.appendChild(i)}catch(e){console.error(e)}}})}},L=i(137),V=i.n(L);i(155);const _={mode:"code",modes:["tree","code"],history:!0,search:!0};var J={install(e){e.directive("jsoneditor",{inserted(e){const t=e.value;try{const i=""!==t&&JSON.parse(t)||{};if(i){e.style.display="none";let t=document.createElement("div");t.className="jsoneditor-container",e.parentElement.insertBefore(t,e),e.dataset.originalValue=e.value;let a=Object.assign(_,{onChange:function(){try{const t=e.jsonEditor.get();e.value=JSON.stringify(t),console.info("valid json :)");let i=e.value!==e.dataset.originalValue;e.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:e.id,isChanged:i}}))}catch(e){console.warn("still not valid json")}}});e.jsonEditor=new V.a(t,a),e.jsonEditor.set(i)}}catch(e){console.error(e)}}})}},U={install(e){e.directive("richeditor",{inserted(e){const t=e.getAttribute("ckconfig");let i={};d&&(i=d[t]);let a=CKEDITOR.replace(e,i);e.dataset.originalValue=e.value,a.on("change",()=>{e.value=a.getData();let t=e.value!==e.dataset.originalValue;e.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:e.id,isChanged:t}}))})}})}},M=i(138),Q=i.n(M);const H=new n.a({el:"main",components:{ModulesIndex:p,ModulesView:S,TrashIndex:T,TrashView:$,ImportView:F,ModelIndex:z,RelationsAdd:I,FilterBoxView:v,EditRelationParams:E},data:()=>({vueLoaded:!1,urlPagination:"",searchQuery:"",pageSize:"",page:"",sort:"",panelIsOpen:!1,panelAction:null,panelData:null,addRelation:{},editingRelationParams:null,dataChanged:!1,urlFilterQuery:{q:"",filter:{}},pagination:{page:"",page_size:""}}),provide(){return{requestPanel:(...e)=>this.requestPanel(...e),closePanel:(...e)=>this.closePanel(...e),returnDataFromPanel:(...e)=>this.returnDataFromPanel(...e)}},beforeCreate(){n.a.use(J),n.a.use(B),n.a.use(U),n.a.use(Q.a),h.a.loadBeditaPlugins()},created(){this.vueLoaded=!0,this.dataChanged=new Map,this.loadUrlParams()},watch:{panelIsOpen(e){var t=document.querySelector("html").classList;e?t.add("is-clipped"):t.remove("is-clipped")},pageSize(e){this.pagination.page_size=e}},mounted:function(){this.$nextTick(function(){this.alertBeforePageUnload(BEDITA.template)})},methods:{onFilterObjects(e){this.urlFilterQuery=e,this.page="",this.applyFilters(this.urlFilterQuery)},onUpdatePageSize(e){this.pageSize=e,this.page="",this.applyFilters(this.urlFilterQuery)},onUpdateCurrentPage(e){this.page=e,this.applyFilters(this.urlFilterQuery)},pageClick(e){},returnDataFromPanel(e){if(this.closePanel(),"add-relation"===e.action&&this.$refs.moduleView.$refs[e.relationName].$refs.relation.appendRelations(e.objects),"edit-params"===e.action){const t=e.item.name;this.$refs.moduleView.$refs[t].$refs.relation.updateRelationParams(e.item)}},closePanel(){this.panelIsOpen=!1,this.addRelation={name:"",alreadyInView:[]},this.editingRelationParams=null},requestPanel(e){this.panelIsOpen=!0,this.panelAction=e.action,this.panelData=e.data,e.relation&&e.relation.name?this.addRelation=e.relation:e.editRelationParams&&e.editRelationParams.name&&(this.editingRelationParams=e.editRelationParams)},loadUrlParams(){if(window.location.search){const e=window.location.search,t=/[?&]q=([^&#]*)/g;let i=e.match(t);i&&i.length&&(i=i.map(e=>e.replace(t,"$1")),this.urlFilterQuery.q=i[0]);const a=/[?&]filter(\[.*?\])=([^&#]*)/g,s=/\[(.*?)\]/g;let n={};for(;i=a.exec(e);)if(i&&3===i.length){const e=i[1],t=i[2];let a=[],o=[];for(;o=s.exec(e);)a.push(o[1]);const r=a.reverse().reduce((e,t)=>{let i={};return i[t]=e,i},t);n=Object(b.a)(n,r)}this.urlFilterQuery.filter=n;const o=/[?&]page_size=([^&#]*)/g;(i=e.match(o))&&i.length&&(i=i.map(e=>e.replace(o,"$1")),this.pageSize=this.isNumeric(i[0])?i[0]:"");const r=/[?&]page=([^&#]*)/g;(i=e.match(r))&&i.length&&(i=i.map(e=>e.replace(r,"$1")),this.page=this.isNumeric(i[0])?i[0]:"");const l=/[?&]sort=([^&#]*)/g;(i=e.match(l))&&i.length&&(i=i.map(e=>e.replace(l,"$1")),this.sort=i[0])}},buildUrlParams(e){let t=`${window.location.origin}${window.location.pathname}`;const i=Object.keys(e);if(i&&i.length){let a=[];i.forEach(t=>{if(e[t]&&""!==e[t]){const i=e[t];if("filter"===t){Object.keys(i).forEach(e=>{if("object"==typeof i[e]){const t=i[e];Object.keys(t).forEach(i=>{""!==t[i]&&a.push(`filter[${e}][${i}]=${t[i]}`)})}else""!==i[e]&&a.push(`filter[${e}]=${i[e]}`)})}else a.push(`${t}=${i}`)}}),t+=a.length?"?":"",t+=a.join("&")}return t},resetFilters(){this.page="",this.pageSize="";this.applyFilters({filter:{},q:""})},applyFilters(e){let t=this.buildUrlParams({q:e.q,filter:e.filter,page_size:this.pageSize,page:this.page,sort:this.sort});window.location.replace(t)},alertBeforePageUnload(e){this.$el.addEventListener("focusin",e=>{const t=e.target,i=t&&t.form;if(i&&"true"===i.getAttribute("check-changes")&&void 0===t.dataset.originalValue)if("INPUT"===t.nodeName)if("radio"===t.type){const e=t.name,i=document.querySelectorAll(`input[name=${e}]`),a=document.querySelector(`input[name=${e}]:checked`);i.forEach(e=>e.dataset.originalValue=a.value)}else if("checkbox"===t.type){const e=t.name;if(e){const i=document.querySelectorAll(`input[name=${e}]:checked`);t.dataset.originalValue=JSON.stringify(i)}}else t.dataset.originalValue=t.value;else"TEXTAREA"===t.nodeName&&(t.dataset.originalValue=t.value)},!0),this.$el.addEventListener("change",e=>{const t=e.target,i=t&&t.form,a=e.detail;if(void 0!==a&&a.id)this.dataChanged.set(a.id,{changed:a.isChanged});else{if(i&&"true"===i.getAttribute("check-changes")){const e=t.name,i=t.form.getAttribute("id"),a=t.id,s=t.dataset.originalValue;let n=t.value,o=`${i}#${a}`;if("radio"===t.type||"checkbox"===t.type){if("checkbox"===t.type){const t=document.querySelectorAll(`input[name=${e}]:checked`);n=JSON.stringify(t)}o=`${i}#${e}`}if(!o||""===o)return!0;this.dataChanged.set(o,{changed:n!==s})}}}),this.$el.addEventListener("submit",e=>{const t=e.target;if(t)if(t.action.endsWith("/delete")){if(!confirm("Do you really want to trash the object?"))return H.dataChanged.clear(),void e.preventDefault()}else H.dataChanged.clear()}),window.onbeforeunload=function(e){let t=!1;for(const[e,i]of H.dataChanged)if(i.changed){t=!0;break}if(t)return"There are unsaved changes, are you sure you want to leave page?"}},isNumeric:e=>!isNaN(e)}});window._vueInstance=H}},[[139,2,1]]]);