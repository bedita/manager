(window.webpackJsonp=window.webpackJsonp||[]).push([["model-index","modules-index"],{"./src/Template/Layout/js/app/pages/model/index.js":function(e,t,s){"use strict";s.r(t);var r=s("./src/Template/Layout/js/app/pages/modules/index.js");t.default={extends:r.default,components:{AutosizeTextarea:()=>Promise.all([s.e("vendors/async/autosize"),s.e("autosize-textarea")]).then(s.bind(null,"./src/Template/Layout/js/app/components/autosize-textarea.js"))},props:{resources:{},csrfToken:{type:String,required:!0}},data:()=>({propertyTypes:[],deletedPropertyTypes:[],savedPropertyTypes:[],newPropertyTypes:[],removePropertyTypes:[],editPropertyTypes:[]}),mounted(){this.propertyTypes=JSON.parse(this.resources)},computed:{formIsModified(){const e=!!(this.newPropertyTypes.length||this.removePropertyTypes.length||this.editPropertyTypes.length);return this.$el&&this.$el.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{id:this.$vnode.tag,isChanged:e}})),e}},methods:{editPropParams(e,t){let s=null;try{""!==t&&(s=JSON.parse(t),Object.keys(s).length||(s=null))}catch(e){return void console.info("[editPropParams] params JSON parse failed - skipping this one...")}const r={id:e,attributes:{params:s}};this.editPropertyType(r)},editPropName(e,t){const s={id:e,attributes:{name:t}};this.editPropertyType(s)},addRow(){this.newPropertyTypes.push({name:"",params:""})},removeRow(e){const t=this.newPropertyTypes.indexOf(e);-1!==t&&this.newPropertyTypes.splice(t,1)},removePropertyType(e){this.removePropertyTypes.push(e)},undoRemovePropertyType(e){const t=this.removePropertyTypes.indexOf(e);-1!==t&&this.removePropertyTypes.splice(t,1)},save(e){if(this.removePropertyTypes.length&&!confirm(`Do you really want to trash these property types? ${this.removePropertyTypes.join(", ")}`))return void e.preventDefault();let t=window.location.href.replace(window.location.search,""),s=new Headers({"Content-Type":"application/json",Accept:"application/json","X-CSRF-Token":this.csrfToken}),r={_csrfToken:this.csrfToken,addPropertyTypes:[...this.newPropertyTypes],removePropertyTypes:[...this.removePropertyTypes],editPropertyTypes:[...this.editPropertyTypes]};const i={method:"POST",credentials:"same-origin",headers:s,body:JSON.stringify(r)},o=`${t}/savePropertyTypesJson`;fetch(o,i).then(e=>e.json()).then(e=>{const t=e.saved||[],s=e.removed||[],r=e.edited||[];this.savedPropertyTypes.push(...t),this.deletedPropertyTypes.push(...s),r.forEach(e=>{this.propertyTypes=this.propertyTypes.map(t=>t.id===e.id?e:t),this.savedPropertyTypes=this.savedPropertyTypes.map(t=>t.id===e.id?e:t)}),this.$children.forEach(e=>{try{JSON.parse(e.text)}catch(t){e.text=e.originalValue}}),this.newPropertyTypes=[],this.removePropertyTypes=[],this.editPropertyTypes=[]}).catch(e=>{console.log(e)})},editPropertyType(e){let t=[...this.propertyTypes,...this.savedPropertyTypes];const[s]=t.filter(t=>t.id==e.id);this.editPropertyTypes.filter(t=>t.id===e.id).length?this.editPropertyTypes=this.editPropertyTypes.map(t=>t.id===e.id?{id:e.id,attributes:{...t.attributes,...e.attributes}}:t):this.editPropertyTypes.push(e),this.editPropertyTypes=this.editPropertyTypes.filter(e=>{return!(Object.keys(e.attributes).filter(t=>JSON.stringify(e.attributes[t])===JSON.stringify(s.attributes[t])).length===Object.keys(e.attributes).length)})},formatParams(e){let t="";if(e&&e.attributes&&e.attributes.params)try{t=JSON.stringify(e.attributes.params,null,4)}catch(e){t=e.message}return t},containsId:(e,t)=>e.filter(e=>"object"==typeof e&&"id"in e?e.id===t:e===t).length}}},"./src/Template/Layout/js/app/pages/modules/index.js":function(e,t,s){"use strict";s.r(t),t.default={props:{ids:{type:String,default:()=>[]}},data:()=>({allIds:[],selectedRows:[]}),created(){try{this.allIds=JSON.parse(this.ids)}catch(e){console.error(e)}},computed:{selectedIds(){return JSON.stringify(this.selectedRows)},allChecked(){return JSON.stringify(this.selectedRows.sort())==JSON.stringify(this.allIds.sort())}},methods:{toggleAll(){this.allChecked?this.unCheckAll():this.checkAll()},checkAll(){this.selectedRows=JSON.parse(JSON.stringify(this.allIds))},unCheckAll(){this.selectedRows=[]},bulkActions(){this.selectedRows.length},exportSelected(){this.selectedRows.length<1||document.getElementById("form-export").submit()},exportAll(){this.unCheckAll(),this.$nextTick(()=>{document.getElementById("form-export").submit()})},trash(){this.selectedRows.length<1||confirm("Move "+this.selectedRows.length+" item to trash")&&document.getElementById("form-delete").submit()},selectRow(e){if("checkbox"!=e.target.type){e.preventDefault();var t=e.target.querySelector("input[type=checkbox]");let s=this.selectedRows.indexOf(t.value);-1!=s?this.selectedRows.splice(s,1):this.selectedRows.push(t.value)}}}}}}]);