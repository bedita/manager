{% set here=Link.here({'no-query': true}) %}

<script type="text/javascript">
$(document).ready(function(){
    $('select[name={{ relation }}PageSize]').change(function(event){
        let relationUrl = "{{ here }}?page_size=" + event.target.value;
        let target = 'div#related_{{ relation }}';
        let loader = 'div#loader_{{ relation }}';
        $(loader).show();
        $.get(relationUrl, function( data ) {
            $(target).html(data);
            $(loader).hide();
        });
    });
    $('a.relatedPage').on('click', (ev) => {
        ev.preventDefault();
        let page = ev.target.getAttribute('data-page');
        let relationUrl = "{{ here }}?page_size=" + $('select[name={{ relation }}PageSize]').val() + '&page=' + page;
        let target = 'div#related_{{ relation }}';
        let loader = 'div#loader_{{ relation }}';
        $(loader).show();
        $.get(relationUrl, function( data ) {
            $(target).html(data);
            $(loader).hide();
        });
    });
});
</script>
