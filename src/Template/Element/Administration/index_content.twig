{% element ('Administration/sidebar') %}

{% do _view.assign('title', 'Administration ' ~ resourceType|humanize) %}
{% do _view.assign('bodyViewClass',  'view-module view-model') %}

<div class="module-header">
    <header>
        <h1>{{ title }}</h1>
    </header>
</div>

{% element 'Modules/index_header' { 'meta': meta, 'filter': filter, 'Schema': Schema, 'hidePagination': treeView} %}

<div class="module-index">
    <div class="list-objects">

        {# list resources : table header #}
        <nav class="table-header has-border-black">
            <div>{{ __('Id') }}</div>
            {% for prop in properties %}
                {% set label = prop %}
                {% if prop == 'object_type_name' %}
                    {% set label = 'type' %}
                {% endif %}
                <div class="{{ Link.sortClass(prop) }}"><a href="{{ Link.sortUrl(prop) }}">{{ __(label)|humanize }}</a></div>
            {% endfor %}
            {% for prop in metaColumns %}
                <div>{{ prop }}</div>
            {% endfor %}
            <div></div>
        </nav>
        {% if resources|count == 0 %}
            <p>{{ __('Resources not available') }}</p>
        {% endif %}

        {# list resources : rows #}
        {% for resource in resources %}

            {{ Form.create(null, {
                'url': {'_name': 'administration:save:' ~ resourceType},
                'id': 'form-' ~ resource.id,
                'class': 'table-row',
            })|raw }}
                <div class="{{ prop }}-cell" untitled-label="{{ __('Untitled') }}">
                    {{ resource.id }}
                </div>
                {% for prop in properties %}
                    {% set propVal = resource.attributes[prop] %}

                    <div class="{{ prop }}-cell" untitled-label="{{ __('Untitled') }}">
                        {{ Schema.format(propVal, schema.properties[prop]) }}
                    </div>
                {% endfor %}
                {% for prop in metaColumns %}
                    <div>{{ resource.meta[prop] }}</div>
                {% endfor %}
                <div class="buttons-cell narrow">
                    {# {% set buttonClasses = 'button button-text-white is-width-auto' %}

                    {{ Form.button( __('Save'),
                        {
                            'form': 'form-' ~ resource.id,
                            'title': __('Save') ~ resource.attributes.name,
                            'class': buttonClasses,
                        })|raw }}

                    {{ Form.postButton(__('Remove'),
                        {'_name': 'administration:remove:' ~ resource.type, 'id': resource.id},
                        {
                            'title': __('Remove') ~ resource.attributes.name,
                            'class': buttonClasses,
                        })|raw }} #}
                </div>

            {{ Form.hidden('id', {'value': resource.id})|raw }}
            {{ Form.end()|raw }}

        {% endfor %}

    </div>

</div>
