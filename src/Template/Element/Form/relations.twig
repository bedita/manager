{#
    load-on-start, loading events timing:
    1000ms    - first relation
    gap 200ms - till last relation
#}

{% if objectRelations %}
<section class="relations">

    {% for relationName, relationLabel in objectRelations %}

        <div class="relation">
            <property-view inline-template :tab-open="tabsOpen" ref={{ relationName }}>
                <section class="fieldset order-{{ cssOrder }}" :class="isOpen? '' : 'closed'">

                    <header @click.prevent="toggleVisibility();" class="tab unselectable" v-bind:class="isLoading? 'is-loading-spinner' : ''">
                        <h2>
                            {{ relationLabel }}
                            <span class="tag is-smallest is-black mx-05"
                                :class="!totalObjects? 'empty' : ''"><: totalObjects :>
                            </span>
                        </h2>
                    </header>

                    {% set wait = config('ajaxLoadDelay.start')|default(0) + (loop.index * config('ajaxLoadDelay.interval')|default(0)) %}
                    {% if relationName == 'children' %}
                        <div v-show="isOpen" class="tab-container">
                            {% element 'Form/children' {'relationName': relationName, 'loadOnStart': wait } %}
                        </div>
                    {% else %}
                        <div v-show="isOpen" class="tab-container">
                            {% element 'Form/relation' {'relationName': relationName, 'relationSchema': relationsSchema[relationName], 'loadOnStart': wait } %}
                        </div>
                    {% endif %}

                </section>
            </property-view>
        </div>

    {% endfor %}

</section>
{% endif %}
