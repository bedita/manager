<!DOCTYPE html>
<!--

██████╗ ███████╗██████╗ ██╗████████╗ █████╗     ██╗  ██╗
██╔══██╗██╔════╝██╔══██╗██║╚══██╔══╝██╔══██╗    ██║  ██║
██████╔╝█████╗  ██║  ██║██║   ██║   ███████║    ███████║
██╔══██╗██╔══╝  ██║  ██║██║   ██║   ██╔══██║    ╚════██║
██████╔╝███████╗██████╔╝██║   ██║   ██║  ██║         ██║
╚═════╝ ╚══════╝╚═════╝ ╚═╝   ╚═╝   ╚═╝  ╚═╝         ╚═╝

BEdita 4 ~ @ 2018 from ChannelWeb & Chialab with love
-->

<html>
<head>
    {{ Html.charset()|raw }}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {{ Html.meta('favicon.ico', '/favicon.ico', {'type': 'icon'})|raw }}

    {# fonts #}
    {{ Html.css(['be-icons-font'])|raw }}
    {{ Html.css(['be-icons-codes'])|raw }}

    {# vendors.css it's only generated when vendors css are imported statically, uncomment if you do so #}
    {# {{ Html.css(['app.b59441'])|raw }} #}
    {{ Link.cssBundle([ 'app', 'vendors' ])|raw }}

    {% element 'custom_colors' %}

    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i|IBM+Plex+Serif&display=swap&subset=latin-ext" rel="stylesheet prefetch" crossorigin>

    <title>{{ "#{_view.fetch('title')} | #{project.name ?: 'BEdita 4'}" }}</title>

    {% element 'json_meta_config' %}
</head>

<body class="{% if currentModule %}view-module module-{{ currentModule.name }}{% endif %} {{ _view.fetch('bodyViewClass') }}"
    {% if config('AlertMessage.text') %}alert-message="{{ config('AlertMessage.text') }}"{% endif %}>
    <main
        v-cloak
        class="layout"
        @click="pageClick($event)">

        {% if not Layout.isLogin() %}
        <aside class="layout-sidebar">
            {% element 'Menu/sidebar' %}
        </aside>
        {% endif %}

        {% if not Layout.isLogin() and not Layout.isDashboard() %}
            <header class="layout-header">
                {% element 'Menu/menu' %}
            </header>
        {% endif %}

        <div class="layout-content">
            {{ _view.fetch('content')|raw }}
        </div>

        {% if not Layout.isLogin() %}
        <div class="layout-footer">
            {% element 'Menu/colophon' %}
        </div>
        {% endif %}

        {% if not Layout.isLogin() and not Layout.isDashboard() %}
            {% element 'panel' %}
        {% endif %}

        {# flash messages #}
        {% if Layout.messages() %}
            {{ Flash.render()|raw }}
        </section>
    {% endif %}
    </main>


    {# set timezone-offset value before login #}
    {% if _view.name == 'Login' %}
    <script>
        Date.prototype.stdTimezoneOffset = function() {
            var jan = new Date(this.getFullYear(), 0, 1);
            var jul = new Date(this.getFullYear(), 6, 1);
            return Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());
        }

        Date.prototype.dst = function() {
            return this.getTimezoneOffset() < this.stdTimezoneOffset();
        }

        document.addEventListener("DOMContentLoaded", function() {
            var inputTZElement = document.getElementById('timezone-offset');
            if (inputTZElement) {
                var tz = (-60) * (new Date().getTimezoneOffset()) + ' ' + (new Date().dst() ? '1' : '0');
                inputTZElement.value = tz;
            }
        });
    </script>
    {% endif %}


    {# {{ Html.script('manifest.bundle')|raw }} #}

    {# vendors.bundle it's only generated when vendors are imported statically, uncomment if you do so #}
    {# {{ Html.script('vendors.bundle')|raw }} #}

    {{ Link.pluginsJsBundle()|raw }}

    {{ Link.jsBundle([ 'manifest', 'vendors', 'app' ])|raw }}

    {# {{ Html.script('app.bundle')|raw }} #}

</body>
</html>
