{% do _view.assign('bodyViewClass', 'translation-module') %}

<modules-view inline-template ref="moduleView">
<div class="modules-view" v-hotkey="keyEvents">

    {% if object.id %}
    <header>
        <h1 untitled-label="{{ __('Untitled') }}">{{ translation.attributes.translated_fields.title }} <span>[{{ __('translation of') }}]</span> {{ object.attributes.title }}</h1>
    </header>
    {% endif %}

    <div class="module-form">

        {# TODO: route di salvataggio e action da vedere #}
        {{ Form.create(null, {
            'url': {'_name': 'modules:save', 'object_type': objectType},
            'id': 'form-translate',
        })|raw }}

            <header class="form-header">
                <section class="fieldset">
                    {{ Form.control('status', {
                        'type': 'radio',
                        'options': {
                            'on': 'on',
                            'off': 'off',
                            'draft': 'draft',
                            'todo': 'to do',
                        },
                        'value': translation.attributes.status,
                    })|raw }}
                </section>
                <section class="fieldset">
                    {% set languageLabel = "#{__('Language')} (#{__('original')}: #{object.attributes.lang})" %}
                    {{ Form.control('lang', {
                        'label': languageLabel,
                        'type': 'select',
                        'options': {
                            'mul': 'muliseno',
                            'it': 'itulieno',
                        },
                        'value': translation.attributes.lang,
                    })|raw }}

                </section>
            </header>

            <div class="form-column">
                <section class="fieldset order-{{ order|default('0') }}">
                    <div class="tab-container">
                        {% for key in translatable %}
                            <div class="input text ">
                                {% set options = Schema.controlOptions(key, translation.attributes.translated_fields[key], schema.properties[key]) %}
                                {{ Form.control(key, options)|raw }}
                            </div>
                        {% endfor %}
                    </div>
                </section>
            </div>

            <div class="form-column original">
                <section class="fieldset order-{{ order|default('0') }}">
                    <div class="tab-container">
                        {% for key in translatable %}
                            <div class="input text ">
                                {% set options = Schema.controlOptions(key, object.attributes[key], schema.properties[key]) %}
                                {% set options = options|merge({'disabled': 'disabled'}) %}
                                {{ Form.control(key, options)|raw }}
                            </div>
                        {% endfor %}
                    </div>
            </div>

        {{ Form.end()|raw }}

        {# TODO: da fare salvataggio e eliminazione #}
        {# Append "Save" to commands in commands menu. Must stay here, before the form end. #}
        {# {% do _view.append('commands', Form.submit(__('Save'), {'form': 'form-translate'})) %} #}
        {# Append "Delete" to commands in commands menu. #}
        {# {% do _view.append('commands', Form.postButton(__('Trash'), {'_name': 'modules:deleteTranslation', 'object_type': objectType}, {'data': {'id': object.id}})) %} #}
    </div>

</div>
</modules-view>
