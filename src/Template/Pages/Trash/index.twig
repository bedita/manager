{% do _view.assign('title', currentModule.name|humanize) %}

{% set q = _view.request.query|serialize|escape %}
{% set msg = __('If you confirm, this data will be gone forever') %}
{% set confirm = "return confirm('" ~ msg ~ "')" %}

<trash-index inline-template>
    <div>

        {% element 'Modules/header' %}

        <div class="module-content">
            <div class="list-objects">
                <nav class="table-header">
                    <div>{{ Link.sort('title')}}</div>
                    <div>{{ Link.sort('id')}}</div>
                    <div>{{ __('type') }}</div>
                    <div>{{ __('status') }}</div>
                    <div>{{ Link.sort('modified')}}</div>
                    <div></div>
                </nav>

                {% for object in objects %}
                    <a
                        href="{{ Url.build({'_name': 'trash:view', 'id': object.id}) }}"
                        title="{{ object.attributes.title }}"
                        class="object-status-{{ object.attributes.status }}">
                            <div>{{ object.attributes.title }}</div>
                            <div>{{ object.id }}</div>
                            <div>{{ object.type }}</div>
                            <div>{{ object.attributes.status }}</div>
                            <div>{{ Time.format(object.meta.modified) }}</div>
                            <div>
                            {% if in_array('PATCH', currentModule.hints.allow) %}
                                {{ Form.postButton(__('Restore'), {'_name': 'trash:restore'}, {'data': {'id': object.id, 'query': q}})|raw }}
                            {% endif %}
                            {% if in_array('DELETE', currentModule.hints.allow) %}
                                {{ Form.postButton(__('Delete'), {'_name': 'trash:delete'}, {'data': {'id': object.id, 'query': q}, 'onclick': confirm})|raw }}
                            {% endif %}
                            </div>
                    </a>
                {% else %}
                    {{ __('No items found') }}
                {% endfor %}
            </div>

            {# Append "Empty" button in commands menu. #}
            {% do _view.append('commands',
                Form.postButton(__('Empty'), {'_name': 'trash:empty'}, {'data': {'query': q}, 'onclick': confirm})|raw
            )%}
        </div>
    </div>
</trash-index>
